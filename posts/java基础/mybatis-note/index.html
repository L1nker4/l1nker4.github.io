<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="generator" content="Hugo 0.145.0">

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="" />
  <meta property="og:url" content="http://localhost:1313/posts/java%E5%9F%BA%E7%A1%80/mybatis-note/" />
  <link rel="canonical" href="http://localhost:1313/posts/java%E5%9F%BA%E7%A1%80/mybatis-note/" /><link rel="apple-touch-icon" href="/favicon.png" />
  <link rel="icon" href="/favicon.png" />
  <link rel="shortcut" href="/favicon.png" /><link rel="alternate" type="application/atom+xml" href="http://localhost:1313/index.xml" title="l1nker4&#39;s Blog | 格木观云">

  <script type="application/ld+json">
  {
      "@context" : "http://schema.org",
      "@type" : "BlogPosting",
      "mainEntityOfPage": {
           "@type": "WebPage",
           "@id": "http:\/\/localhost:1313\/"
      },
      "articleSection" : "posts",
      "name" : "Mybatis学习笔记",
      "headline" : "Mybatis学习笔记",
      "description" : "Mybatis简介 开源免费框架，原名叫iBatis\n作用：数据访问层框架，底层是对JDBC的封装\n优点：\n使用mybatis时不需要编写实现类，只需要写执行的sql命令 Mybatis简单使用 mybatis-config.xml：全局配置文件\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE configuration PUBLIC \u0026#34;-\/\/mybatis.org\/\/DTD Config 3.0\/\/EN\u0026#34; \u0026#34;http:\/\/mybatis.org\/dtd\/mybatis-3-config.dtd\u0026#34;\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;environments default=\u0026#34;default\u0026#34;\u0026gt; \u0026lt;environment id=\u0026#34;default\u0026#34;\u0026gt; \u0026lt;transactionManager type=\u0026#34;JDBC\u0026#34;\/\u0026gt; \u0026lt;dataSource type=\u0026#34;POOLED\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;driver\u0026#34; value=\u0026#34;com.mysql.jdbc.Driver\u0026#34;\/\u0026gt; \u0026lt;property name=\u0026#34;url\u0026#34; value=\u0026#34;jdbc:mysql:\/\/localhost:3308\/learnjsp?useSSL=false\u0026#34;\/\u0026gt; \u0026lt;property name=\u0026#34;username\u0026#34; value=\u0026#34;root\u0026#34;\/\u0026gt; \u0026lt;property name=\u0026#34;password\u0026#34; value=\u0026#34;root\u0026#34;\/\u0026gt; \u0026lt;\/dataSource\u0026gt; \u0026lt;\/environment\u0026gt; \u0026lt;\/environments\u0026gt; \u0026lt;mappers\u0026gt; \u0026lt;mapper resource=\u0026#34;UserMapper.xml\u0026#34;\/\u0026gt; \u0026lt;\/mappers\u0026gt; \u0026lt;\/configuration\u0026gt; mapper.xml文件：编写需要执行的SQL命令，把XML文件理解成实现类\nUserMapper.xml：配置了sql语句，以及sql的封装规则\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-\/\/mybatis.org\/\/DTD Mapper 3.0\/\/EN\u0026#34; \u0026#34;http:\/\/mybatis.org\/dtd\/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;!--namespace:命名空间--\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.test.UserMapper\u0026#34;\u0026gt; \u0026lt;!-- id:sql语句的唯一标识 parameterType:定义参数类型 resultType:返回值类型 如果方法返回值返回的是list,在resultType中写List的泛型 #{id}:外部传入的参数 --\u0026gt; \u0026lt;select id=\u0026#34;selectUser\u0026#34; resultType=\u0026#34;com.test.model.User\u0026#34;\u0026gt; select uid,uname,pwd,sex,age from t_user where id = #{id} \u0026lt;\/select\u0026gt; \u0026lt;\/mapper\u0026gt; 测试\n",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "2019",
      "datePublished": "2019-04-08 13:44:13 \u002b0000 UTC",
      "dateModified" : "2019-04-08 13:44:13 \u002b0000 UTC",
      "url" : "http:\/\/localhost:1313\/posts\/java%E5%9F%BA%E7%A1%80\/mybatis-note\/",
      "keywords" : [ "Java","Mybatis", ]
  }
</script>
<title>Mybatis学习笔记</title>
  <meta property="og:title" content="Mybatis学习笔记" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Mybatis简介 开源免费框架，原名叫iBatis
作用：数据访问层框架，底层是对JDBC的封装
优点：
使用mybatis时不需要编写实现类，只需要写执行的sql命令 Mybatis简单使用 mybatis-config.xml：全局配置文件
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt; &lt;!DOCTYPE configuration PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34; &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt; &lt;configuration&gt; &lt;environments default=&#34;default&#34;&gt; &lt;environment id=&#34;default&#34;&gt; &lt;transactionManager type=&#34;JDBC&#34;/&gt; &lt;dataSource type=&#34;POOLED&#34;&gt; &lt;property name=&#34;driver&#34; value=&#34;com.mysql.jdbc.Driver&#34;/&gt; &lt;property name=&#34;url&#34; value=&#34;jdbc:mysql://localhost:3308/learnjsp?useSSL=false&#34;/&gt; &lt;property name=&#34;username&#34; value=&#34;root&#34;/&gt; &lt;property name=&#34;password&#34; value=&#34;root&#34;/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;mappers&gt; &lt;mapper resource=&#34;UserMapper.xml&#34;/&gt; &lt;/mappers&gt; &lt;/configuration&gt; mapper.xml文件：编写需要执行的SQL命令，把XML文件理解成实现类
UserMapper.xml：配置了sql语句，以及sql的封装规则
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt; &lt;!DOCTYPE mapper PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34; &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt; &lt;!--namespace:命名空间--&gt; &lt;mapper namespace=&#34;com.test.UserMapper&#34;&gt; &lt;!-- id:sql语句的唯一标识 parameterType:定义参数类型 resultType:返回值类型 如果方法返回值返回的是list,在resultType中写List的泛型 #{id}:外部传入的参数 --&gt; &lt;select id=&#34;selectUser&#34; resultType=&#34;com.test.model.User&#34;&gt; select uid,uname,pwd,sex,age from t_user where id = #{id} &lt;/select&gt; &lt;/mapper&gt; 测试
" />
  <meta name="description" content="Mybatis简介 开源免费框架，原名叫iBatis
作用：数据访问层框架，底层是对JDBC的封装
优点：
使用mybatis时不需要编写实现类，只需要写执行的sql命令 Mybatis简单使用 mybatis-config.xml：全局配置文件
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt; &lt;!DOCTYPE configuration PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34; &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt; &lt;configuration&gt; &lt;environments default=&#34;default&#34;&gt; &lt;environment id=&#34;default&#34;&gt; &lt;transactionManager type=&#34;JDBC&#34;/&gt; &lt;dataSource type=&#34;POOLED&#34;&gt; &lt;property name=&#34;driver&#34; value=&#34;com.mysql.jdbc.Driver&#34;/&gt; &lt;property name=&#34;url&#34; value=&#34;jdbc:mysql://localhost:3308/learnjsp?useSSL=false&#34;/&gt; &lt;property name=&#34;username&#34; value=&#34;root&#34;/&gt; &lt;property name=&#34;password&#34; value=&#34;root&#34;/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;mappers&gt; &lt;mapper resource=&#34;UserMapper.xml&#34;/&gt; &lt;/mappers&gt; &lt;/configuration&gt; mapper.xml文件：编写需要执行的SQL命令，把XML文件理解成实现类
UserMapper.xml：配置了sql语句，以及sql的封装规则
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt; &lt;!DOCTYPE mapper PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34; &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt; &lt;!--namespace:命名空间--&gt; &lt;mapper namespace=&#34;com.test.UserMapper&#34;&gt; &lt;!-- id:sql语句的唯一标识 parameterType:定义参数类型 resultType:返回值类型 如果方法返回值返回的是list,在resultType中写List的泛型 #{id}:外部传入的参数 --&gt; &lt;select id=&#34;selectUser&#34; resultType=&#34;com.test.model.User&#34;&gt; select uid,uname,pwd,sex,age from t_user where id = #{id} &lt;/select&gt; &lt;/mapper&gt; 测试
" />
  <meta property="og:locale" content="en-us" /><meta property="og:image" content="/favicon.png" />
  

  
    <style>body{font-family:bree serif,sans-serif;-webkit-font-smoothing:antialiased;margin:0 20px}article{max-width:1000px;margin-left:auto;margin-right:auto}a{color:#000;text-decoration:none}a:hover{font-weight:600;text-decoration:underline}.post-ads{margin:50px 0}.markdown-body{font-size:18px}.markdown-body a{text-decoration:underline;text-decoration-color:#000}.markdown-body blockquote{margin:0;padding:0 1em;color:#57606a;border-left:.25em solid #d0d7de}.markdown-body pre{padding:16px;overflow:auto;border-radius:10px}.markdown-body code{padding:.2em .4em;font-size:85%;background-color:#f6f8fa;border-radius:6px}.markdown-body pre>code{padding:0;font-size:85%;background-color:inherit;border:0;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:1.6}.Chinese .markdown-body{line-height:200%}.site-date-catalog{font-size:2rem}.header-title{font-size:2rem;font-weight:700;margin-top:32px}.header-title a{text-decoration:none}.header-subtitle{color:#666}.header-items{margin:10px 0}.header-item{margin:0 5px}.header-line{width:100%;border-width:2px;border-color:#482936;border-style:solid none none none}.lang-switch{font-weight:600}#posts-list{min-height:600px}.posts-line{font-size:1.2rem;margin:12px 0}.posts-categories{font-size:.8rem;margin:auto;text-align:center}.posts-category{padding:3px 0;border:#000 2px solid;border-radius:5px}.site-footer{margin-top:50px}.site-footer-item{margin-right:12px}.post-header{margin-bottom:50px}.post-title{font-size:2rem;font-weight:600}.post-tags{display:inline;font-weight:600;padding:2px 5px;margin-right:6px;border:#000 2px solid;border-radius:5px}.post-date{font-weight:800;font-style:italic}.post-author{float:right;font-weight:600}.page-content{min-height:60%}.post-content{margin-bottom:50px}.post-content p{hyphens:auto;line-height:1.8;text-justify:ideographic;margin-bottom:1em}.post-content img{max-width:100%;display:block;margin-right:auto;margin-top:6px}.post-content .post-gallery{display:flex;flex-wrap:wrap;gap:6px}.post-content .post-gallery img{margin-right:auto;margin-top:auto;width:calc(50% - 3px)}.related-content{border-width:3px;border-style:solid;border-color:#000;padding:0 10px;margin-bottom:50px;margin-top:100px}.related-content li{margin:5px 0}.taxonomy-term{font-size:3rem}.gallery-img{text-align:center}.gallery-img span{text-align:center}.gallery-img-desc{font-size:.8em;font-weight:800}#disqus_thread{position:relative}#disqus_thread:after{content:"";display:block;height:55px;width:100%;position:absolute;bottom:0;background:#fff}@media screen and (max-width:600px){.header-title,.header-subtitle,.header-items{}.posts-line{font-size:16px}.markdown-body{font-size:16px}.post-title{font-size:2rem}.post-content p{letter-spacing:.05em}.post-content .post-gallery img{width:100%}}@media screen and (max-width:48em){.posts-category{display:none}}table,th,td{border-collapse:collapse;border-style:solid}</style>
  
  
    <style>.container,.container-fluid{margin-right:auto;margin-left:auto}.container-fluid{padding-right:2rem;padding-left:2rem}.row{box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:initial;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-.5rem;margin-left:-.5rem}.row.reverse{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.col.reverse{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.col-xs,.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-offset-0,.col-xs-offset-1,.col-xs-offset-10,.col-xs-offset-11,.col-xs-offset-12,.col-xs-offset-2,.col-xs-offset-3,.col-xs-offset-4,.col-xs-offset-5,.col-xs-offset-6,.col-xs-offset-7,.col-xs-offset-8,.col-xs-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-xs{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-xs-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-xs-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-xs-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-xs-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-xs-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-xs-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-xs-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-xs-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-xs-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-xs-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-xs-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-xs-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-xs-offset-0{margin-left:0}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-11{margin-left:91.66666667%}.start-xs{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-xs{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-xs{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-xs{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-xs{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-xs{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-xs{-ms-flex-pack:distribute;justify-content:space-around}.between-xs{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-xs{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-xs{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}@media only screen and (min-width:48em){.container{width:49rem}.col-sm,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-offset-0,.col-sm-offset-1,.col-sm-offset-10,.col-sm-offset-11,.col-sm-offset-12,.col-sm-offset-2,.col-sm-offset-3,.col-sm-offset-4,.col-sm-offset-5,.col-sm-offset-6,.col-sm-offset-7,.col-sm-offset-8,.col-sm-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-sm{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-sm-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-sm-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-sm-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-sm-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-sm-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-sm-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-sm-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-sm-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-sm-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-sm-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-sm-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-sm-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-sm-offset-0{margin-left:0}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-11{margin-left:91.66666667%}.start-sm{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-sm{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-sm{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-sm{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-sm{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-sm{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-sm{-ms-flex-pack:distribute;justify-content:space-around}.between-sm{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-sm{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-sm{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:64em){.container{width:65rem}.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-offset-0,.col-md-offset-1,.col-md-offset-10,.col-md-offset-11,.col-md-offset-12,.col-md-offset-2,.col-md-offset-3,.col-md-offset-4,.col-md-offset-5,.col-md-offset-6,.col-md-offset-7,.col-md-offset-8,.col-md-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-md{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-md-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-md-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-md-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-md-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-md-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-md-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-md-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-md-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-md-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-md-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-md-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-md-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-md-offset-0{margin-left:0}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-3{margin-left:25%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-6{margin-left:50%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-9{margin-left:75%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-11{margin-left:91.66666667%}.start-md{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-md{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-md{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-md{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-md{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-md{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-md{-ms-flex-pack:distribute;justify-content:space-around}.between-md{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-md{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-md{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:75em){.container{width:76rem}.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-offset-0,.col-lg-offset-1,.col-lg-offset-10,.col-lg-offset-11,.col-lg-offset-12,.col-lg-offset-2,.col-lg-offset-3,.col-lg-offset-4,.col-lg-offset-5,.col-lg-offset-6,.col-lg-offset-7,.col-lg-offset-8,.col-lg-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-lg{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-lg-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-lg-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-lg-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-lg-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-lg-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-lg-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-lg-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-lg-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-lg-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-lg-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-lg-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-lg-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-lg-offset-0{margin-left:0}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-11{margin-left:91.66666667%}.start-lg{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-lg{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-lg{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-lg{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-lg{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-lg{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-lg{-ms-flex-pack:distribute;justify-content:space-around}.between-lg{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-lg{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-lg{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}</style>
  

  

  <link href="/index.xml" rel="alternate" type="application/rss+xml"
    title="l1nker4&#39;s Blog | 格木观云">
  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css?family=Bree+Serif|Bungee+Shade" rel="stylesheet">
  
  

  
  
</head>


<body>
  <article class="post " id="article">
    <div class="row">
      <div class="col-xs-12">
        <div class="site-header">
          
<header>
  <div class="header-title">
    <a href="/"
      >L1nker4&#39;s Blog</a
    >
  </div>
  <div class="header-subtitle">提升认知，解构世界，行有不得，反求诸己</div>
</header>
<div class="row end-md header-items">
  
  <div class="header-item">
    <a href="/links" target="_blank">Links</a>
  </div>
  
  <div class="header-item">
    <a href="/about" target="_blank">About</a>
  </div>
  
  <div class="header-item">
    <a href="/index.xml" target="_blank">RSS</a>
  </div>
  
</div>
<div class="row">
   
</div>
<div class="header-line"></div>

        </div>
        <header class="post-header">
          <h1 class="post-title">Mybatis学习笔记</h1>
          
          <div class="row post-desc">
            <div class="col-xs-6">
              
              <time class="post-date" datetime="2019-04-08 13:44:13 UTC">
                
                  2019-04-08
                
              </time>
              
            </div>
            <div class="col-xs-6">
              
            </div>
          </div>
          
        </header>

        <div class="row">
          <div class="col-xs-12 col-md-9">
            <div class="post-content markdown-body">
              
              <h3 id="mybatis简介">Mybatis简介</h3>
<p>开源免费框架，原名叫iBatis</p>
<p>作用：数据访问层框架，底层是对JDBC的封装</p>
<p>优点：</p>
<ul>
<li>使用mybatis时不需要编写实现类，只需要写执行的sql命令</li>
</ul>
<h3 id="mybatis简单使用">Mybatis简单使用</h3>
<p>mybatis-config.xml：全局配置文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE configuration
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;environments</span> <span style="color:#a6e22e">default=</span><span style="color:#e6db74">&#34;default&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;environment</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;default&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;transactionManager</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;JDBC&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;dataSource</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;POOLED&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;driver&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;com.mysql.jdbc.Driver&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;url&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;jdbc:mysql://localhost:3308/learnjsp?useSSL=false&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;username&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/dataSource&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/environment&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/environments&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;mappers&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">resource=</span><span style="color:#e6db74">&#34;UserMapper.xml&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/mappers&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span></code></pre></div><p>mapper.xml文件：编写需要执行的SQL命令，把XML文件理解成实现类</p>
<p>UserMapper.xml：配置了sql语句，以及sql的封装规则</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE mapper
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--namespace:命名空间--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">namespace=</span><span style="color:#e6db74">&#34;com.test.UserMapper&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    id:sql语句的唯一标识
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    parameterType:定义参数类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    resultType:返回值类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    如果方法返回值返回的是list,在resultType中写List的泛型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#{id}:外部传入的参数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;selectUser&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;com.test.model.User&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        select uid,uname,pwd,sex,age from t_user where id = #{id}
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/select&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/mapper&gt;</span>
</span></span></code></pre></div><p>测试</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> com.test.test;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> com.test.model.User;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.ibatis.io.Resources;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.ibatis.session.SqlSession;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.ibatis.session.SqlSessionFactory;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.IOException;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.InputStream;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.List;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @author ：L1nker4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @date ： 创建于  2019/3/10 17:19
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @description： test
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Test</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>        String resource <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mybatis-config.xml&#34;</span>;
</span></span><span style="display:flex;"><span>        InputStream inputStream <span style="color:#f92672">=</span> Resources.<span style="color:#a6e22e">getResourceAsStream</span>(resource);
</span></span><span style="display:flex;"><span>        SqlSessionFactory sqlSessionFactory <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SqlSessionFactoryBuilder().<span style="color:#a6e22e">build</span>(inputStream);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//获取sqlSession实例，能直接执行已经映射的sql语句</span>
</span></span><span style="display:flex;"><span>        SqlSession openSession <span style="color:#f92672">=</span>  sqlSessionFactory.<span style="color:#a6e22e">openSession</span>();
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> user <span style="color:#f92672">=</span> openSession.<span style="color:#a6e22e">selectList</span>(<span style="color:#e6db74">&#34;com.test.UserMapper.selectUser&#34;</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(user);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//关闭session</span>
</span></span><span style="display:flex;"><span>        openSession.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Mybatis使用步骤：</p>
<ol>
<li>
<p>根据配置文件，创建一个SqlSessionFactory对象</p>
</li>
<li>
<p>sql映射文件，配置sql语句</p>
</li>
<li>
<p>将sql映射文件注册到全局配置文件中</p>
</li>
<li>
<p>写代码</p>
<ol>
<li>根据全局配置文件得到SqlSessionFactory</li>
<li>使用sqlSession工厂，获取到sqlSession对象使用它来执行增删改查，一个SqlSession就是代表和数据库的一次会话，用完关闭。</li>
<li>使用sql的唯一标识来告诉Mybatis执行哪个sql，sql语句都保存在sql映射文件中。</li>
</ol>
</li>
</ol>
<p>接口式编程</p>
<pre><code>原生：		Dao	====&gt;	DaoImpl

Mybatis	      Mapper ====&gt;	xxMapper.xml
</code></pre>
<p>mapper接口没有实现类，但是mybatis会为这个接口生成一个代理对象。</p>
<p>mybatis的配置文件：包含数据库连接池的信息，事务管理器信息等，系统运行环境。</p>
<p>sql映射文件：保存了每一个sql语句的映射信息。</p>
<h3 id="mybatis全局配置文件">Mybatis全局配置文件</h3>
<p>Mybatis的配置文件包含了影响Mybatis行为的设置（setting）和属性（properties）信息。</p>
<p>configuration 配置</p>
<pre><code>properties属性

settings 设置

typeAliases 类型命名

typeHandlers 类型处理器

objectFactory 对象工厂

plugins	插件

environments 环境

	environment 环境变量

		transactionManager	事务管理器

		dataSource 数据源
</code></pre>
<p>databaseIdProvider 提供多个数据库厂商</p>
<p>mappers 映射器</p>
<h4 id="properties-引入配置">properties 引入配置</h4>
<p>引入外部properties配置文件的内容</p>
<p>resource：类路径下的资源</p>
<p>url：引入网络路径i心爱的资源</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;properties</span> <span style="color:#a6e22e">resource=</span><span style="color:#e6db74">&#34;db.properties&#34;</span><span style="color:#f92672">&gt;&lt;/properties&gt;</span>
</span></span></code></pre></div><h4 id="setting-mybatis设置">setting Mybatis设置</h4>
<p><img src="C:%5CUsers%5Cl1nke%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1553326004994.png" alt="1553326004994"></p>
<p>setting：用来设置每一个设置项</p>
<pre><code>name：设置项名

value：值
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;settings&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;setting</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;mapUnderscoreToCamelCase&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/settings&gt;</span>
</span></span></code></pre></div><h4 id="typealiases-别名处理器">typeAliases 别名处理器</h4>
<p>typeAliases：可以为Java类型起别名</p>
<pre><code>type：指定要起别名的类型全类名，默认别名就是类名小写

alias：指定新的别名，
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;typeAliases&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;typeAlias</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;com.test.model.User&#34;</span> <span style="color:#a6e22e">alias=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/typeAliases&gt;</span>
</span></span></code></pre></div><h5 id="package批量起别名">package：批量起别名</h5>
<pre><code>name：指定包名（为当前包以及下面的所有后代包的每一个类都起一个默认别名）
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;package</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;com.test.entities&#34;</span><span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p>批量起别名的情况下，使用@Alias注解为某个类型指定新的别名</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Alias</span>(<span style="color:#e6db74">&#34;per&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span>{
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="environments-环境">environments 环境</h4>
<p>Mybatis可以配置多种环境，default属性指定使用某种环境</p>
<p>environment：配置一个具体的环境信息，必须有以下两个标签，id代表当前环境的唯一标识</p>
<pre><code>transactionManager：事务管理器，

		type：事务管理器的类型，JDBC和MANAGED

		自定义事务管理器，实现TransactionFactory接口即可

dataSource：数据源

		type：数据源类型，UNPOOLED，POOLED，JNDI	

		自定义数据源：实现DataSourceFactory接口
</code></pre>
<p>​</p>
<h4 id="databaseidprovider-提供多数据库厂商">databaseIdProvider 提供多数据库厂商</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;databaseIdProvider</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;DB_VENDOR&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">&lt;!--为不同的数据库厂商起别名--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MySQL&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;mysql&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Oracle&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;oracle&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/databaseIdProvider&gt;</span>
</span></span></code></pre></div><p>在sql映射文件中使用databaseId指定查询哪个数据库（值由配置文件中的别名决定）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;selectUser&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span> <span style="color:#a6e22e">databaseId=</span><span style="color:#e6db74">&#34;mysql&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        select uid,uname,pwd,sex,age from t_user;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/select&gt;</span>
</span></span></code></pre></div><h4 id="mappers-映射">mappers 映射</h4>
<p>将sql映射注册到全局配置中</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;mappers&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">resource=</span><span style="color:#e6db74">&#34;UserMapper.xml&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/mappers&gt;</span>
</span></span></code></pre></div><p>注册配置文件</p>
<p>resource：引入类路径下的映射文件</p>
<p>url：引入磁盘或者网络路径下的映射文件</p>
<p>注册接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;com.test.dao.UserMapper&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span></code></pre></div><p>class：引用接口</p>
<p>接口和映射文件同名，并且存在于同一目录下</p>
<h5 id="批量注册">批量注册</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;package</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;xxx.com.dao&#34;</span><span style="color:#f92672">&gt;&lt;/package&gt;</span>
</span></span></code></pre></div><p>配置文件和dao一个目录</p>
<h3 id="mybatis映射文件">Mybatis映射文件</h3>
<p>cache：命名空间的二级缓存配置</p>
<p>cache-ref：其他命名空间缓存配置的引用。</p>
<p>resultMap：自定义结果集映射</p>
<p>sql：抽取可重用语句块</p>
<p>insert：映射插入语句</p>
<p>update：映射更新语句</p>
<p>delete：映射删除语句</p>
<p>select：映射查询语句</p>
<p>mybatis允许增删改直接定义为：long，boolen，Integer。void</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">//这种方式需要手动提交事务，openSession.commit();</span>
</span></span><span style="display:flex;"><span>SqlSession openSession <span style="color:#f92672">=</span>  sqlSessionFactory.<span style="color:#a6e22e">openSession</span>();
</span></span><span style="display:flex;"><span><span style="color:#75715e">//这种不需要提交事务</span>
</span></span><span style="display:flex;"><span>SqlSession openSession <span style="color:#f92672">=</span>  sqlSessionFactory.<span style="color:#a6e22e">openSession</span>(<span style="color:#66d9ef">true</span>);
</span></span></code></pre></div><p>MySQL支持自增主键，自增主键的获取，mybatis利用statement.getGenratedKeys()，</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">insert</span> id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;addUser&#34;</span> parameterType<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;com.test.model.User&#34;</span> useGeneratedKeys<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;true&#34;</span> keyProperty<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> t_user(uname, pwd, sex, age)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">values</span> (<span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">{</span>uname<span style="color:#960050;background-color:#1e0010">}</span>,<span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">{</span>pwd<span style="color:#960050;background-color:#1e0010">}</span>,<span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">{</span>sex<span style="color:#960050;background-color:#1e0010">}</span>,<span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">{</span>age<span style="color:#960050;background-color:#1e0010">}</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/</span><span style="color:#66d9ef">insert</span><span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p>useGeneratedKeys=&ldquo;true&rdquo;，使用自增主键获取主键值策略</p>
<h4 id="参数处理">参数处理</h4>
<p>单个参数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;delete</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;deleteUserById&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        delete from t_user where uid = #{uid}
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/delete&gt;</span>
</span></span></code></pre></div><p>多个参数（多个参数会被封装成一个map）</p>
<p>key：param1，paramN</p>
<p>value：传入的参数值</p>
<p>#{}是从map中获取指定的key的值</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserByIdAndUname&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        select * from t_user where uid = #{param1} and uname = #{param2}
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/select&gt;</span>
</span></span></code></pre></div><h6 id="使用param注解">使用@Param注解</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> User <span style="color:#a6e22e">getUserByIdAndUname</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;uid&#34;</span>) Integer uid, <span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;uname&#34;</span>) String uname);
</span></span></code></pre></div><p>@Param注解指定对应的key值</p>
<h4 id="和的取值区别">#和$的取值区别</h4>
<p>${}：取出的值直接拼接在sql语句中，会有安全问题</p>
<p>#{}：是以预编译的形式，将参数设置到sql语句中，PreparedStatement</p>
<p>大多情况下，取参数都应该使用#{}</p>
<p>原生jdbc不支持占位符的地方，可以使用$进行取值</p>
<p>比如 ：分表，按照年份分表拆分</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>select * from ${year}_salary where xxx;
</span></span></code></pre></div><p>#{}可以规定参数的一些规则</p>
<p>javaType，jdbcType，mode（存储过程），numericScale，resultMap，typeHandler，jdbcTypeName，</p>
<p>jdbcType</p>
<h4 id="select元素">select元素</h4>
<p>id：唯一标识符</p>
<p>parameterType：参数类型</p>
<p>resultType：返回值类型，如果返回的是一个集合，要写集合中元素的类型。</p>
<h6 id="多条记录封装成一个map">多条记录封装成一个map</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserByUnameReturnMap&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;com.test.model.User&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        select * from t_user where uname like #{uname}
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/select&gt;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@MapKey</span>(<span style="color:#e6db74">&#34;uid&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Map<span style="color:#f92672">&lt;</span>Integer,User<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getUserByUnameReturnMap</span>(String uname);
</span></span><span style="display:flex;"><span>MapKey标注某个元素为主键
</span></span></code></pre></div><h6 id="association指定联合的javabean对象">association指定联合的JavaBean对象</h6>
<p>property：指定哪个属性是联合的对象</p>
<p>javaType：指定这个属性对象的类型</p>
<h6 id="association定义关联对象的封装规则">association定义关联对象的封装规则</h6>
<p>select：表明当前属性是调用select指定的方法查出的结果</p>
<p>column：指定将哪一列的值传给这个方法</p>
<p>流程：使用select指定的方法（传入column指定的这列参数的值）查出对象，并封装给property指定的属性</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;association</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;dept&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;com.test.dao.UserMapper.getUserByIdAndUname&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;d_id&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span></code></pre></div><h5 id="延时加载">延时加载</h5>
<p>在关联查询中，例如：查询用户订单情况时，只查用户信息而不查订单，可以启用延时加载</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;settings&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;setting</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;lazyLoadingEnabled&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;setting</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;aggressiveLazyLoading&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;false&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/settings&gt;</span>
</span></span></code></pre></div><h5 id="collection定义关联集合">collection定义关联集合</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;resultMap</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;MyUser&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;com.test.model.User&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;uid&#34;</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;uid&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;uname&#34;</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;uname&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;pwd&#34;</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;pwd&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;sex&#34;</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;sex&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;collection</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;User&#34;</span> <span style="color:#a6e22e">ofType=</span><span style="color:#e6db74">&#34;com.test.model.Department&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;eid&#34;</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;username&#34;</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/collection&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/resultMap&gt;</span>
</span></span></code></pre></div><pre><code>    ofType：指定集合里面元素类型
</code></pre>
<p>collection封装一个集合</p>
<h6 id="将多列的值传递过去">将多列的值传递过去</h6>
<p>将多列的值封装map传递过去</p>
<p>column={key1=column1,key2=column2}</p>
<h4 id="discriminator鉴别器">discriminator鉴别器</h4>
<p>mybatis可以通过discriminator判断某列的值，然后根据某列的值改变封装行为</p>
<p>例如：如果查出的是女生，就把部门信息查询出来，否则不查询</p>
<pre><code>   如果是男生，就把username赋值给email
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;discriminator</span> <span style="color:#a6e22e">javaType=</span><span style="color:#e6db74">&#34;String&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;gender&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">&lt;!--女生 resultType：指定封装的结果类型--&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;case</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;association</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;dept&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;com.test.dao.UserMapper.getUserByIdAndUname&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;d_id&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/case&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;case</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;association</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;dept&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;com.test.dao.UserMapper.getUserByIdAndUname&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;d_id&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/case&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/discriminator&gt;</span>
</span></span></code></pre></div><h3 id="动态sql">动态SQL</h3>
<h4 id="if-判断">if 判断</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserByConditionIf&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;com.test.model.User&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        select * from t_user
</span></span><span style="display:flex;"><span>        where
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;uid != null&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                uid = #{uid}
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;uname != null&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                and uname = #{}
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/select&gt;</span>
</span></span></code></pre></div><p>test：OGNL表达式</p>
<p>遇见特殊字符需要转义</p>
<h4 id="where">where</h4>
<p>可以防止因为if语句不显示，直接拼接and报错</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;where&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;uid != null&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>       uid = #{uid}
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;uname != null&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>       and uname = #{}
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/where&gt;</span>
</span></span></code></pre></div><p>where标签会将所有的查询条件都包括在内。mybatis会将where标签中拼接的sql多出来的and</p>
<p>或者or去掉，<strong>where只会去掉第一个多出来的and或者or</strong></p>
<h4 id="trim-字符串截取">Trim 字符串截取</h4>
<p>自定义字符串截取规则</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;trim</span> <span style="color:#a6e22e">prefix=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#a6e22e">prefixOverrides=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#a6e22e">suffix=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#a6e22e">suffixOverrides=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p>prefix：前缀，trim标签体中是整个字符串拼串后的结果，prefix给拼串后的整个字符加一个前缀</p>
<p>prefixOverrides：前缀覆盖，去掉整个字符串前面多余的字符</p>
<p>suffix：后缀，suffix给拼串后的整个字符加一个后缀</p>
<p>suffixOverrides：后缀覆盖</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;trim</span> <span style="color:#a6e22e">prefix=</span><span style="color:#e6db74">&#34;where&#34;</span> <span style="color:#a6e22e">suffixOverrides=</span><span style="color:#e6db74">&#34;and&#34;</span><span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p>上述代码解释：在字符串前面加一个where，将后缀的and去掉</p>
<h4 id="choose-when-otherwise-分支选择">choose-when-otherwise 分支选择</h4>
<p>相当于switch-case</p>
<p>需求：如果带了id就用id查，如果带了lastName就用lastName查</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserByUnameReturnMap&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;com.test.model.User&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        select * from t_user
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;where&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;choose&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;when</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;id!=null&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                    id = #{id}
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/when&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;when</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;uname!=null&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>                    uname = #{uname}
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/when&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/choose&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/where&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/select&gt;</span>
</span></span></code></pre></div><h4 id="set">set</h4>
<p>set元素可以用于动态包含需要更新的列,可以动态删除多余的逗号</p>
<h4 id="foreach">foreach</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;foreach</span> <span style="color:#a6e22e">collection=</span><span style="color:#e6db74">&#34;ids&#34;</span> <span style="color:#a6e22e">item=</span><span style="color:#e6db74">&#34;item_id&#34;</span> <span style="color:#a6e22e">separator=</span><span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#a6e22e">open=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>       #{item_id}
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/foreach&gt;</span>
</span></span></code></pre></div><p>collection：指定要遍历的集合
list类型的参数会特殊处理封装在map中，map的key就叫list
item：将当前遍历出的元素赋值给指定的变量
separator：每个元素中的分隔符
open：遍历死哦有的结果拼接一个开始的字符
close：拼接一个结束的字符
index：索引</p>
<h4 id="内置参数">内置参数</h4>
<p>不止方法传过来的参数可以用来判断并取值</p>
<p>mybatis默认还有两个内置参数</p>
<p>_parameter：代表整个参数</p>
<pre><code>单个参数：_parameter就是这个参数

多个参数：参数会被封装成一个map，_parameter就代表这个map
</code></pre>
<p>_databaseId：如果配置了databaseIdProvider标签，_databaseId就代表当前数据库的别名</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;_databaseId==&#39;mysql&#39;&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	xxx
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;_parameter!=null&#34;</span><span style="color:#f92672">&gt;&lt;/if&gt;</span>
</span></span></code></pre></div><h4 id="bind">bind</h4>
<p>可以将OGNL表达式的值绑定到一个变量中的值</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;bind</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;_lastName&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;lastName&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;select&gt;</span>
</span></span><span style="display:flex;"><span>    	select * from users where lastName = #{_lastName}
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/select&gt;</span>
</span></span></code></pre></div><h4 id="sql">sql</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;sql</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;Base_Column_List&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    emp_id, emp_name, gender, email, d_id
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/sql&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;insert</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;addEmp&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	insert into tbl_emp (
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;include</span> <span style="color:#a6e22e">refid=</span><span style="color:#e6db74">&#34;Base_Column_List&#34;</span><span style="color:#f92672">&gt;&lt;/include&gt;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    values xxxxx
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/insert&gt;</span>
</span></span></code></pre></div><p>sql标签里面只能用<code>${}</code>进行取值</p>
<h3 id="mybatis缓存">MyBatis缓存</h3>
<p>分为一级缓存（本地缓存）和二级缓存（全局缓存）</p>
<ul>
<li>默认情况下，只有一级缓存（SqlSession级别的缓存，也称为本地缓存）开启</li>
<li>二级缓存需要手动开启和配置，基于namespace级别的缓存</li>
<li>为了提高拓展性，MyBatis定义了缓存接口Cache，我们可以通过实现Cache接口来自定义二级缓存</li>
</ul>
<h4 id="一级缓存">一级缓存</h4>
<p>与数据库同一次会话期间查询到的数据会放在本地缓存中，以后如果获取相同的数据，直接去缓存中取。</p>
<p>失效情况：</p>
<ul>
<li>sqlsession不同</li>
<li>sqlsession相同，查询条件不同</li>
<li>sqlsession相同，两次查询之间执行了增删改操作</li>
<li>sqlsession相同，手动清除了一级缓存</li>
</ul>
<h4 id="二级缓存">二级缓存</h4>
<p>基于namespace级别的缓存，一个namespace对应一个二级缓存。</p>
<h5 id="开启全局二级缓存配置">开启全局二级缓存配置</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;setting</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cacheEnabled&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;&lt;/setting&gt;</span>
</span></span></code></pre></div><h5 id="mapperxml中配置">mapper.xml中配置</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">namespace=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;cache&gt;&lt;/cache&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/mapper&gt;</span>
</span></span></code></pre></div><ul>
<li>eviction：缓存回收策略
<ul>
<li>LRU	最近最少使用的：移除最长时间不被使用的对象</li>
<li>FIFO        先进先出，按对象进入缓存的顺序来移除他们</li>
<li>SOFT       软引用，移除基于垃圾回收器状态和软引用规则的对象</li>
<li>WEAK      弱引用，更积极地移除基于垃圾回收器状态和弱引用规则的对象</li>
<li>默认是LRU</li>
</ul>
</li>
<li>flushInterval：缓存刷新间隔（默认不清空）单位 毫秒</li>
<li>readOnly：是否只读
<ul>
<li>true：只读，mybatis认为所有从缓存中获取数据的操作都是只读操作，不会修改数据，不安全，速度快</li>
<li>false：非只读</li>
</ul>
</li>
<li>size：缓存中存放多少元素</li>
<li>type：指定自定义缓存的全类名，实现Cache接口</li>
</ul>
<h5 id="实体类实现序列化接口">实体类实现序列化接口</h5>

            </div>
          </div>
          <div class="col-xs-12 col-md-3">
            <div class="post-toc">
              <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#mybatis简介">Mybatis简介</a></li>
            <li><a href="#mybatis简单使用">Mybatis简单使用</a></li>
            <li><a href="#mybatis全局配置文件">Mybatis全局配置文件</a>
              <ul>
                <li><a href="#properties-引入配置">properties 引入配置</a></li>
                <li><a href="#setting-mybatis设置">setting Mybatis设置</a></li>
                <li><a href="#typealiases-别名处理器">typeAliases 别名处理器</a>
                  <ul>
                    <li><a href="#package批量起别名">package：批量起别名</a></li>
                  </ul>
                </li>
                <li><a href="#environments-环境">environments 环境</a></li>
                <li><a href="#databaseidprovider-提供多数据库厂商">databaseIdProvider 提供多数据库厂商</a></li>
                <li><a href="#mappers-映射">mappers 映射</a>
                  <ul>
                    <li><a href="#批量注册">批量注册</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#mybatis映射文件">Mybatis映射文件</a>
              <ul>
                <li><a href="#参数处理">参数处理</a>
                  <ul>
                    <li></li>
                  </ul>
                </li>
                <li><a href="#和的取值区别">#和$的取值区别</a></li>
                <li><a href="#select元素">select元素</a>
                  <ul>
                    <li></li>
                    <li><a href="#延时加载">延时加载</a></li>
                    <li><a href="#collection定义关联集合">collection定义关联集合</a></li>
                  </ul>
                </li>
                <li><a href="#discriminator鉴别器">discriminator鉴别器</a></li>
              </ul>
            </li>
            <li><a href="#动态sql">动态SQL</a>
              <ul>
                <li><a href="#if-判断">if 判断</a></li>
                <li><a href="#where">where</a></li>
                <li><a href="#trim-字符串截取">Trim 字符串截取</a></li>
                <li><a href="#choose-when-otherwise-分支选择">choose-when-otherwise 分支选择</a></li>
                <li><a href="#set">set</a></li>
                <li><a href="#foreach">foreach</a></li>
                <li><a href="#内置参数">内置参数</a></li>
                <li><a href="#bind">bind</a></li>
                <li><a href="#sql">sql</a></li>
              </ul>
            </li>
            <li><a href="#mybatis缓存">MyBatis缓存</a>
              <ul>
                <li><a href="#一级缓存">一级缓存</a></li>
                <li><a href="#二级缓存">二级缓存</a>
                  <ul>
                    <li><a href="#开启全局二级缓存配置">开启全局二级缓存配置</a></li>
                    <li><a href="#mapperxml中配置">mapper.xml中配置</a></li>
                    <li><a href="#实体类实现序列化接口">实体类实现序列化接口</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
            </div>
          </div>
        </div>

        <div class="row middle-xs">
          <div class="col-xs-12">
            
            <div class="post-tags">
              <a href="/tags/java/">
                Java
              </a>
            </div>
            
            <div class="post-tags">
              <a href="/tags/mybatis/">
                Mybatis
              </a>
            </div>
            
          </div>
        </div>
        
          <div class="row">
            <div class="col-xs-12">
              
            </div>
          </div>

          



          
          
          <div style="height: 50px;"></div>
          
          <div class="post-comments">
            <div id="disqus_thread"></div>
<script>
  window.addEventListener("load", () => {
    (function() {
      
      var d = document,
        s = d.createElement("script");
      s.src = "https://evl1nker4.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  });
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>

          </div>
          
        

        <div class="site-footer">
  
  
</div>

      </div>
    </div>
  </article>

  

<script>
  
  
    
    
  
</script>

  

</body>

</html>