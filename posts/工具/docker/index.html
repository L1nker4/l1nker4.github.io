<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="generator" content="Hugo 0.140.2">

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="" />
  <meta property="og:url" content="http://localhost:1313/posts/%E5%B7%A5%E5%85%B7/docker/" />
  <link rel="canonical" href="http://localhost:1313/posts/%E5%B7%A5%E5%85%B7/docker/" /><link rel="apple-touch-icon" href="favicon.ico" />
  <link rel="icon" href="favicon.ico" />
  <link rel="shortcut" href="favicon.ico" /><link rel="alternate" type="application/atom+xml" href="http://localhost:1313/index.xml" title="l1nker4&#39;s Blog">

  <script type="application/ld+json">
  {
      "@context" : "http://schema.org",
      "@type" : "BlogPosting",
      "mainEntityOfPage": {
           "@type": "WebPage",
           "@id": "http:\/\/localhost:1313\/"
      },
      "articleSection" : "posts",
      "name" : "Docker学习笔记",
      "headline" : "Docker学习笔记",
      "description" : "1.Docker概念 模型 虚拟机运行在虚拟的硬件上，应用运行在虚拟机内核上，而Docker是机器上的一个进程，Docker应用是Docker的一个子进程。 Docker是对Linux容器（LXC）的一种封装，提供简单易用的接口，Docker是目前最流行的Linux容器解决方案。 Docker用途 提供一次性的环境。主要用于测试。 提供云服务 组建微服务架构。 Docker引擎 Docker 引擎是一个包含以下主要组件的客户端服务器应用程序。\n一种服务器，它是一种称为守护进程并且长时间运行的程序。 REST API用于指定程序可以用来与守护进程通信的接口，并指示它做什么。 一个有命令行界面工具的客户端。 Docker系统架构 Docker 使用客户端-服务器 (C\/S) 架构模式，使用远程 API 来管理和创建 Docker 容器。\nDocker 容器通过 Docker 镜像来创建。\n容器和对象的关系可以类似于对象和类。\nDocker镜像 在Linux下，内核启动会挂载root文件系统，Docker镜像就相当于一个root文件系统，它除了提供容器运行时所需的程序，资源，配置之外，还有一些配置参数（匿名卷，环境变量，用户）。\nDocker镜像使用分层存储技术，它并非像ISO镜像那样的文件，镜像是一个虚拟的概念，它是由一组文件系统构成。\nDocker容器 容器的本质是进程，容器进程运行于属于自己的命名空间，它可以拥有自己的root文件系统，自己的网络配置等宿主机可以有的东西。\n每一个容器运行时，都是以镜像为基础层，在其上创建一个当前容器的存储层，可以称这个为容器运行时读写而准备的存储层为容器存储层。\nDocker仓库 存放镜像的地方\n2.安装Docker 1.获取脚本并下载 \/\/从官网获取安装脚本 $ curl -fsSL get.docker.com -o get-docker.sh \/\/使用AzureChinaCloud镜像脚本 $ sudo sh get-docker.sh --mirror AzureChinaCloud 2.启动Docker $ sudo systemctl enable docker $ sudo systemctl start docker 3.建立Docker用户组 docker命令只有root用户和docker组的用户才能访问docker引擎\n建立Docker组 $ sudo groupadd docker 将当前用户加入Docker组 $ sudo usermod -aG docker $USER 校验是否安装成功 l1nker4@zero:~$ docker version Client: Version: 18.09.6 API version: 1.39 Go version: go1.10.8 Git commit: 481bc77 Built: Sat May 4 02:35:57 2019 OS\/Arch: linux\/amd64 Experimental: false Server: Docker Engine - Community Engine: Version: 18.09.6 API version: 1.39 (minimum version 1.12) Go version: go1.10.8 Git commit: 481bc77 Built: Sat May 4 01:59:36 2019 OS\/Arch: linux\/amd64 Experimental: false 4. 添加镜像加速器 新建daemon.json文件 $ sudo touch \/etc\/docker\/daemon.json 添加内容 { \u0026#34;registry-mirrors\u0026#34;: [ \u0026#34;https:\/\/registry.docker-cn.com\u0026#34; ] } 3.常用命令 1.镜像操作 名称 命令 作用 搜索 docker search xxx 搜索镜像 拉取 docker pull xxx 从仓库拉取镜像 列表 docker images 列出所有镜像 删除 docker rmi imageID 删除镜像 2.容器操作 名称 命令 说明 运行 docker run \u0026ndash;name container-name -d image-name \u0026ndash;name：自定义容器名，-d：后台运行，image-name：指定镜像模板 列表 docker ps 查看运行中的容器，-a：查看所有容器 停止 docker stop container-name\/container-id 停止当前你运行的容器 启动 docker start container-name\/container-id 启动容器 删除 docker rm container-id s删除指定容器 端口映射 -p 6379:6379 -p：主机端口映射到容器内部端口 docker run -d -p 8888:8080 tomcat -d：后台运行，-p：端口映射\n",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "2019",
      "datePublished": "2019-05-27 20:18:39 \u002b0000 UTC",
      "dateModified" : "2019-05-27 20:18:39 \u002b0000 UTC",
      "url" : "http:\/\/localhost:1313\/posts\/%E5%B7%A5%E5%85%B7\/docker\/",
      "keywords" : [ "Docker", ]
  }
</script>
<title>Docker学习笔记</title>
  <meta property="og:title" content="Docker学习笔记" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="1.Docker概念 模型 虚拟机运行在虚拟的硬件上，应用运行在虚拟机内核上，而Docker是机器上的一个进程，Docker应用是Docker的一个子进程。 Docker是对Linux容器（LXC）的一种封装，提供简单易用的接口，Docker是目前最流行的Linux容器解决方案。 Docker用途 提供一次性的环境。主要用于测试。 提供云服务 组建微服务架构。 Docker引擎 Docker 引擎是一个包含以下主要组件的客户端服务器应用程序。
一种服务器，它是一种称为守护进程并且长时间运行的程序。 REST API用于指定程序可以用来与守护进程通信的接口，并指示它做什么。 一个有命令行界面工具的客户端。 Docker系统架构 Docker 使用客户端-服务器 (C/S) 架构模式，使用远程 API 来管理和创建 Docker 容器。
Docker 容器通过 Docker 镜像来创建。
容器和对象的关系可以类似于对象和类。
Docker镜像 在Linux下，内核启动会挂载root文件系统，Docker镜像就相当于一个root文件系统，它除了提供容器运行时所需的程序，资源，配置之外，还有一些配置参数（匿名卷，环境变量，用户）。
Docker镜像使用分层存储技术，它并非像ISO镜像那样的文件，镜像是一个虚拟的概念，它是由一组文件系统构成。
Docker容器 容器的本质是进程，容器进程运行于属于自己的命名空间，它可以拥有自己的root文件系统，自己的网络配置等宿主机可以有的东西。
每一个容器运行时，都是以镜像为基础层，在其上创建一个当前容器的存储层，可以称这个为容器运行时读写而准备的存储层为容器存储层。
Docker仓库 存放镜像的地方
2.安装Docker 1.获取脚本并下载 //从官网获取安装脚本 $ curl -fsSL get.docker.com -o get-docker.sh //使用AzureChinaCloud镜像脚本 $ sudo sh get-docker.sh --mirror AzureChinaCloud 2.启动Docker $ sudo systemctl enable docker $ sudo systemctl start docker 3.建立Docker用户组 docker命令只有root用户和docker组的用户才能访问docker引擎
建立Docker组 $ sudo groupadd docker 将当前用户加入Docker组 $ sudo usermod -aG docker $USER 校验是否安装成功 l1nker4@zero:~$ docker version Client: Version: 18.09.6 API version: 1.39 Go version: go1.10.8 Git commit: 481bc77 Built: Sat May 4 02:35:57 2019 OS/Arch: linux/amd64 Experimental: false Server: Docker Engine - Community Engine: Version: 18.09.6 API version: 1.39 (minimum version 1.12) Go version: go1.10.8 Git commit: 481bc77 Built: Sat May 4 01:59:36 2019 OS/Arch: linux/amd64 Experimental: false 4. 添加镜像加速器 新建daemon.json文件 $ sudo touch /etc/docker/daemon.json 添加内容 { &#34;registry-mirrors&#34;: [ &#34;https://registry.docker-cn.com&#34; ] } 3.常用命令 1.镜像操作 名称 命令 作用 搜索 docker search xxx 搜索镜像 拉取 docker pull xxx 从仓库拉取镜像 列表 docker images 列出所有镜像 删除 docker rmi imageID 删除镜像 2.容器操作 名称 命令 说明 运行 docker run &ndash;name container-name -d image-name &ndash;name：自定义容器名，-d：后台运行，image-name：指定镜像模板 列表 docker ps 查看运行中的容器，-a：查看所有容器 停止 docker stop container-name/container-id 停止当前你运行的容器 启动 docker start container-name/container-id 启动容器 删除 docker rm container-id s删除指定容器 端口映射 -p 6379:6379 -p：主机端口映射到容器内部端口 docker run -d -p 8888:8080 tomcat -d：后台运行，-p：端口映射
" />
  <meta name="description" content="1.Docker概念 模型 虚拟机运行在虚拟的硬件上，应用运行在虚拟机内核上，而Docker是机器上的一个进程，Docker应用是Docker的一个子进程。 Docker是对Linux容器（LXC）的一种封装，提供简单易用的接口，Docker是目前最流行的Linux容器解决方案。 Docker用途 提供一次性的环境。主要用于测试。 提供云服务 组建微服务架构。 Docker引擎 Docker 引擎是一个包含以下主要组件的客户端服务器应用程序。
一种服务器，它是一种称为守护进程并且长时间运行的程序。 REST API用于指定程序可以用来与守护进程通信的接口，并指示它做什么。 一个有命令行界面工具的客户端。 Docker系统架构 Docker 使用客户端-服务器 (C/S) 架构模式，使用远程 API 来管理和创建 Docker 容器。
Docker 容器通过 Docker 镜像来创建。
容器和对象的关系可以类似于对象和类。
Docker镜像 在Linux下，内核启动会挂载root文件系统，Docker镜像就相当于一个root文件系统，它除了提供容器运行时所需的程序，资源，配置之外，还有一些配置参数（匿名卷，环境变量，用户）。
Docker镜像使用分层存储技术，它并非像ISO镜像那样的文件，镜像是一个虚拟的概念，它是由一组文件系统构成。
Docker容器 容器的本质是进程，容器进程运行于属于自己的命名空间，它可以拥有自己的root文件系统，自己的网络配置等宿主机可以有的东西。
每一个容器运行时，都是以镜像为基础层，在其上创建一个当前容器的存储层，可以称这个为容器运行时读写而准备的存储层为容器存储层。
Docker仓库 存放镜像的地方
2.安装Docker 1.获取脚本并下载 //从官网获取安装脚本 $ curl -fsSL get.docker.com -o get-docker.sh //使用AzureChinaCloud镜像脚本 $ sudo sh get-docker.sh --mirror AzureChinaCloud 2.启动Docker $ sudo systemctl enable docker $ sudo systemctl start docker 3.建立Docker用户组 docker命令只有root用户和docker组的用户才能访问docker引擎
建立Docker组 $ sudo groupadd docker 将当前用户加入Docker组 $ sudo usermod -aG docker $USER 校验是否安装成功 l1nker4@zero:~$ docker version Client: Version: 18.09.6 API version: 1.39 Go version: go1.10.8 Git commit: 481bc77 Built: Sat May 4 02:35:57 2019 OS/Arch: linux/amd64 Experimental: false Server: Docker Engine - Community Engine: Version: 18.09.6 API version: 1.39 (minimum version 1.12) Go version: go1.10.8 Git commit: 481bc77 Built: Sat May 4 01:59:36 2019 OS/Arch: linux/amd64 Experimental: false 4. 添加镜像加速器 新建daemon.json文件 $ sudo touch /etc/docker/daemon.json 添加内容 { &#34;registry-mirrors&#34;: [ &#34;https://registry.docker-cn.com&#34; ] } 3.常用命令 1.镜像操作 名称 命令 作用 搜索 docker search xxx 搜索镜像 拉取 docker pull xxx 从仓库拉取镜像 列表 docker images 列出所有镜像 删除 docker rmi imageID 删除镜像 2.容器操作 名称 命令 说明 运行 docker run &ndash;name container-name -d image-name &ndash;name：自定义容器名，-d：后台运行，image-name：指定镜像模板 列表 docker ps 查看运行中的容器，-a：查看所有容器 停止 docker stop container-name/container-id 停止当前你运行的容器 启动 docker start container-name/container-id 启动容器 删除 docker rm container-id s删除指定容器 端口映射 -p 6379:6379 -p：主机端口映射到容器内部端口 docker run -d -p 8888:8080 tomcat -d：后台运行，-p：端口映射
" />
  <meta property="og:locale" content="en-us" /><meta property="og:image" content="favicon.ico" />
  

  
    <style>body{font-family:bree serif,sans-serif;-webkit-font-smoothing:antialiased;margin:0 20px}article{max-width:800px;margin-left:auto;margin-right:auto}a{color:#000;text-decoration:none}a:hover{font-weight:600;text-decoration:underline}.post-ads{margin:50px 0}.markdown-body{font-size:18px;max-width:100%}.markdown-body a{text-decoration:underline;text-decoration-color:#000}.markdown-body blockquote{margin:0;padding:0 1em;color:#57606a;border-left:.25em solid #d0d7de}.markdown-body pre{padding:16px;overflow:auto;border-radius:10px}.markdown-body code{padding:.2em .4em;font-size:85%;background-color:#f6f8fa;border-radius:6px}.markdown-body pre>code{padding:0;font-size:85%;background-color:inherit;border:0;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace}.Chinese .markdown-body{line-height:200%}.site-date-catalog{font-size:2rem}.header-title{font-size:2rem;font-weight:700;margin-top:32px;font-family:bungee shade,sans-serif}.header-title a{text-decoration:none}.header-subtitle{color:#666}.header-items{margin:10px 0}.header-item{margin:0 5px}.header-line{width:100%;border-width:2px;border-color:#482936;border-style:solid none none none}.lang-switch{font-weight:600}#posts-list{min-height:600px}.posts-line{font-size:1.2rem;margin:12px 0}.posts-categories{font-size:.8rem;margin:auto;text-align:center}.posts-category{padding:3px 0;border:#000 2px solid;border-radius:5px}.site-footer{margin-top:50px}.site-footer-item{margin-right:12px}.post-header{margin-bottom:50px}.post-title{font-size:2rem;font-weight:600}.post-tags{display:inline;font-weight:600;padding:2px 5px;margin-right:6px;border:#000 2px solid;border-radius:5px}.post-date{font-weight:800;font-style:italic}.post-author{float:right;font-weight:600}.page-content{min-height:60%}.post-content{margin-bottom:50px}.post-content p{hyphens:auto;line-height:1.8;text-justify:ideographic;margin-bottom:1em}.post-content img{max-width:100%;display:block;margin-right:auto;margin-top:6px}.post-content .post-gallery{display:flex;flex-wrap:wrap;gap:6px}.post-content .post-gallery img{margin-right:auto;margin-top:auto;width:calc(50% - 3px)}.related-content{border-width:3px;border-style:solid;border-color:#000;padding:0 10px;margin-bottom:50px;margin-top:100px}.related-content li{margin:5px 0}.taxonomy-term{font-size:3rem}.gallery-img{text-align:center}.gallery-img span{text-align:center}.gallery-img-desc{font-size:.8em;font-weight:800}#disqus_thread{position:relative}#disqus_thread:after{content:"";display:block;height:55px;width:100%;position:absolute;bottom:0;background:#fff}@media screen and (max-width:600px){.header-title,.header-subtitle,.header-items{}.posts-line{font-size:16px}.markdown-body{font-size:16px}.post-title{font-size:2rem}.post-content p{letter-spacing:.05em}.post-content .post-gallery img{width:100%}}@media screen and (max-width:48em){.posts-category{display:none}}table,th,td{border-collapse:collapse;border-style:solid}</style>
  
  
    <style>.container,.container-fluid{margin-right:auto;margin-left:auto}.container-fluid{padding-right:2rem;padding-left:2rem}.row{box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:initial;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-.5rem;margin-left:-.5rem}.row.reverse{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.col.reverse{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.col-xs,.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-offset-0,.col-xs-offset-1,.col-xs-offset-10,.col-xs-offset-11,.col-xs-offset-12,.col-xs-offset-2,.col-xs-offset-3,.col-xs-offset-4,.col-xs-offset-5,.col-xs-offset-6,.col-xs-offset-7,.col-xs-offset-8,.col-xs-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-xs{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-xs-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-xs-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-xs-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-xs-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-xs-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-xs-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-xs-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-xs-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-xs-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-xs-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-xs-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-xs-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-xs-offset-0{margin-left:0}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-11{margin-left:91.66666667%}.start-xs{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-xs{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-xs{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-xs{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-xs{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-xs{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-xs{-ms-flex-pack:distribute;justify-content:space-around}.between-xs{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-xs{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-xs{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}@media only screen and (min-width:48em){.container{width:49rem}.col-sm,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-offset-0,.col-sm-offset-1,.col-sm-offset-10,.col-sm-offset-11,.col-sm-offset-12,.col-sm-offset-2,.col-sm-offset-3,.col-sm-offset-4,.col-sm-offset-5,.col-sm-offset-6,.col-sm-offset-7,.col-sm-offset-8,.col-sm-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-sm{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-sm-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-sm-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-sm-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-sm-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-sm-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-sm-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-sm-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-sm-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-sm-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-sm-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-sm-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-sm-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-sm-offset-0{margin-left:0}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-11{margin-left:91.66666667%}.start-sm{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-sm{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-sm{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-sm{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-sm{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-sm{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-sm{-ms-flex-pack:distribute;justify-content:space-around}.between-sm{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-sm{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-sm{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:64em){.container{width:65rem}.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-offset-0,.col-md-offset-1,.col-md-offset-10,.col-md-offset-11,.col-md-offset-12,.col-md-offset-2,.col-md-offset-3,.col-md-offset-4,.col-md-offset-5,.col-md-offset-6,.col-md-offset-7,.col-md-offset-8,.col-md-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-md{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-md-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-md-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-md-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-md-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-md-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-md-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-md-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-md-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-md-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-md-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-md-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-md-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-md-offset-0{margin-left:0}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-3{margin-left:25%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-6{margin-left:50%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-9{margin-left:75%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-11{margin-left:91.66666667%}.start-md{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-md{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-md{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-md{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-md{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-md{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-md{-ms-flex-pack:distribute;justify-content:space-around}.between-md{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-md{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-md{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:75em){.container{width:76rem}.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-offset-0,.col-lg-offset-1,.col-lg-offset-10,.col-lg-offset-11,.col-lg-offset-12,.col-lg-offset-2,.col-lg-offset-3,.col-lg-offset-4,.col-lg-offset-5,.col-lg-offset-6,.col-lg-offset-7,.col-lg-offset-8,.col-lg-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-lg{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-lg-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-lg-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-lg-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-lg-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-lg-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-lg-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-lg-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-lg-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-lg-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-lg-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-lg-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-lg-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-lg-offset-0{margin-left:0}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-11{margin-left:91.66666667%}.start-lg{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-lg{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-lg{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-lg{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-lg{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-lg{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-lg{-ms-flex-pack:distribute;justify-content:space-around}.between-lg{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-lg{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-lg{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}</style>
  

  

  <link href="/index.xml" rel="alternate" type="application/rss+xml"
    title="l1nker4&#39;s Blog">
  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css?family=Bree+Serif|Bungee+Shade" rel="stylesheet">
  
  

  
  
</head>


<body>
  <article class="post " id="article">
    <div class="row">
      <div class="col-xs-12">
        <div class="site-header">
          
<header>
  <div class="header-title">
    <a href="/"
      >L1nker4</a
    >
  </div>
  <div class="header-subtitle"></div>
</header>
<div class="row end-md header-items">
  
  <div class="header-item">
    <a href="/links" target="_blank">Links</a>
  </div>
  
  <div class="header-item">
    <a href="/about" target="_blank">About</a>
  </div>
  
</div>
<div class="row">
   
</div>
<div class="header-line"></div>

        </div>
        <header class="post-header">
          <h1 class="post-title">Docker学习笔记</h1>
          
          <div class="row post-desc">
            <div class="col-xs-6">
              
              <time class="post-date" datetime="2019-05-27 20:18:39 UTC">
                27 May 2019
              </time>
              
            </div>
            <div class="col-xs-6">
              
            </div>
          </div>
          
        </header>

        <div class="post-content markdown-body">
          
          <h2 id="1docker概念">1.Docker概念</h2>
<h3 id="模型">模型</h3>
<p><img src="https://blog-1251613845.cos.ap-shanghai.myqcloud.com/docker/docker.png" alt="docker.png"></p>
<ul>
<li>虚拟机运行在虚拟的硬件上，应用运行在虚拟机内核上，而Docker是机器上的一个进程，Docker应用是Docker的一个子进程。</li>
<li>Docker是对Linux容器（LXC）的一种封装，提供简单易用的接口，Docker是目前最流行的Linux容器解决方案。</li>
</ul>
<h3 id="docker用途">Docker用途</h3>
<ul>
<li>提供一次性的环境。主要用于测试。</li>
<li>提供云服务</li>
<li>组建微服务架构。</li>
</ul>
<h3 id="docker引擎">Docker引擎</h3>
<p>Docker 引擎是一个包含以下主要组件的客户端服务器应用程序。</p>
<ul>
<li>一种服务器，它是一种称为守护进程并且长时间运行的程序。</li>
<li>REST API用于指定程序可以用来与守护进程通信的接口，并指示它做什么。</li>
<li>一个有命令行界面工具的客户端。</li>
</ul>
<p><img src="https://blog-1251613845.cos.ap-shanghai.myqcloud.com/docker/620140640_31678.png" alt="620140640_31678.png"></p>
<h3 id="docker系统架构">Docker系统架构</h3>
<p>Docker 使用客户端-服务器 (C/S) 架构模式，使用远程 API 来管理和创建 Docker 容器。</p>
<p>Docker 容器通过 Docker 镜像来创建。</p>
<p>容器和对象的关系可以类似于对象和类。</p>
<p><img src="https://blog-1251613845.cos.ap-shanghai.myqcloud.com/docker/262150629_86976.png" alt="262150629_86976.png"></p>
<h3 id="docker镜像">Docker镜像</h3>
<p>在Linux下，内核启动会挂载<code>root</code>文件系统，Docker镜像就相当于一个<code>root</code>文件系统，它除了提供容器运行时所需的程序，资源，配置之外，还有一些配置参数（匿名卷，环境变量，用户）。</p>
<p>Docker镜像使用分层存储技术，它并非像ISO镜像那样的文件，镜像是一个虚拟的概念，它是由一组文件系统构成。</p>
<h3 id="docker容器">Docker容器</h3>
<p>容器的本质是进程，容器进程运行于属于自己的命名空间，它可以拥有自己的<code>root</code>文件系统，自己的网络配置等宿主机可以有的东西。</p>
<p>每一个容器运行时，都是以镜像为基础层，在其上创建一个当前容器的存储层，可以称这个为容器运行时读写而准备的存储层为<strong>容器存储层</strong>。</p>
<h3 id="docker仓库">Docker仓库</h3>
<p>存放镜像的地方</p>
<h2 id="2安装docker">2.安装Docker</h2>
<h4 id="1获取脚本并下载">1.获取脚本并下载</h4>
<pre tabindex="0"><code>//从官网获取安装脚本
$ curl -fsSL get.docker.com -o get-docker.sh
//使用AzureChinaCloud镜像脚本
$ sudo sh get-docker.sh --mirror AzureChinaCloud
</code></pre><h4 id="2启动docker">2.启动Docker</h4>
<pre tabindex="0"><code>$ sudo systemctl enable docker
$ sudo systemctl start docker
</code></pre><h4 id="3建立docker用户组">3.建立Docker用户组</h4>
<p>docker命令只有root用户和docker组的用户才能访问docker引擎</p>
<h5 id="建立docker组">建立Docker组</h5>
<pre tabindex="0"><code>$ sudo groupadd docker
</code></pre><h5 id="将当前用户加入docker组">将当前用户加入Docker组</h5>
<pre tabindex="0"><code>$ sudo usermod -aG docker $USER
</code></pre><h5 id="校验是否安装成功">校验是否安装成功</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>l1nker4@zero:~$ docker version 
</span></span><span style="display:flex;"><span>Client:
</span></span><span style="display:flex;"><span> Version:           18.09.6
</span></span><span style="display:flex;"><span> API version:       1.39
</span></span><span style="display:flex;"><span> Go version:        go1.10.8
</span></span><span style="display:flex;"><span> Git commit:        481bc77
</span></span><span style="display:flex;"><span> Built:             Sat May  <span style="color:#ae81ff">4</span> 02:35:57 <span style="color:#ae81ff">2019</span>
</span></span><span style="display:flex;"><span> OS/Arch:           linux/amd64
</span></span><span style="display:flex;"><span> Experimental:      false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Server: Docker Engine - Community
</span></span><span style="display:flex;"><span> Engine:
</span></span><span style="display:flex;"><span>  Version:          18.09.6
</span></span><span style="display:flex;"><span>  API version:      1.39 <span style="color:#f92672">(</span>minimum version 1.12<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Go version:       go1.10.8
</span></span><span style="display:flex;"><span>  Git commit:       481bc77
</span></span><span style="display:flex;"><span>  Built:            Sat May  <span style="color:#ae81ff">4</span> 01:59:36 <span style="color:#ae81ff">2019</span>
</span></span><span style="display:flex;"><span>  OS/Arch:          linux/amd64
</span></span><span style="display:flex;"><span>  Experimental:     false
</span></span></code></pre></div><h4 id="4-添加镜像加速器">4. 添加镜像加速器</h4>
<h5 id="新建daemonjson文件">新建daemon.json文件</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo touch /etc/docker/daemon.json
</span></span></code></pre></div><h5 id="添加内容">添加内容</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;registry-mirrors&#34;</span>: [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;https://registry.docker-cn.com&#34;</span>
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="3常用命令">3.常用命令</h2>
<h4 id="1镜像操作">1.镜像操作</h4>
<table>
  <thead>
      <tr>
          <th style="text-align: center">名称</th>
          <th style="text-align: center">命令</th>
          <th style="text-align: center">作用</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">搜索</td>
          <td style="text-align: center">docker search xxx</td>
          <td style="text-align: center">搜索镜像</td>
      </tr>
      <tr>
          <td style="text-align: center">拉取</td>
          <td style="text-align: center">docker pull xxx</td>
          <td style="text-align: center">从仓库拉取镜像</td>
      </tr>
      <tr>
          <td style="text-align: center">列表</td>
          <td style="text-align: center">docker images</td>
          <td style="text-align: center">列出所有镜像</td>
      </tr>
      <tr>
          <td style="text-align: center">删除</td>
          <td style="text-align: center">docker rmi imageID</td>
          <td style="text-align: center">删除镜像</td>
      </tr>
  </tbody>
</table>
<h4 id="2容器操作">2.容器操作</h4>
<table>
  <thead>
      <tr>
          <th style="text-align: center">名称</th>
          <th style="text-align: center">命令</th>
          <th style="text-align: center">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">运行</td>
          <td style="text-align: center">docker run &ndash;name container-name -d image-name</td>
          <td style="text-align: center">&ndash;name：自定义容器名，-d：后台运行，image-name：指定镜像模板</td>
      </tr>
      <tr>
          <td style="text-align: center">列表</td>
          <td style="text-align: center">docker ps</td>
          <td style="text-align: center">查看运行中的容器，-a：查看所有容器</td>
      </tr>
      <tr>
          <td style="text-align: center">停止</td>
          <td style="text-align: center">docker stop container-name/container-id</td>
          <td style="text-align: center">停止当前你运行的容器</td>
      </tr>
      <tr>
          <td style="text-align: center">启动</td>
          <td style="text-align: center">docker start container-name/container-id</td>
          <td style="text-align: center">启动容器</td>
      </tr>
      <tr>
          <td style="text-align: center">删除</td>
          <td style="text-align: center">docker rm container-id</td>
          <td style="text-align: center">s删除指定容器</td>
      </tr>
      <tr>
          <td style="text-align: center">端口映射</td>
          <td style="text-align: center">-p 6379:6379</td>
          <td style="text-align: center">-p：主机端口映射到容器内部端口</td>
      </tr>
  </tbody>
</table>
<pre tabindex="0"><code>docker run -d -p 8888:8080 tomcat
</code></pre><p>-d：后台运行，-p：端口映射</p>
<h2 id="3-dockerfile制作镜像">3. Dockerfile制作镜像</h2>
<h3 id="1from指定基础镜像">1.FROM指定基础镜像</h3>
<p>举例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>FROM tomcat
</span></span></code></pre></div><h3 id="2run执行命令">2.RUN执行命令</h3>
<p>RUN每条运行的命令都会创建一层新的镜像。 可以使用<code>&amp;&amp;</code>进行命令的连接。</p>
<h4 id="1shell格式">1.shell格式</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>FROM tomcat
</span></span><span style="display:flex;"><span>RUN echo “hello docker” &gt; /usr/local/tomcat/webapps/ROOT/index.html
</span></span></code></pre></div><h3 id="构建镜像">构建镜像</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker build -t test .
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Sending build context to Docker daemon  2.048kB
</span></span><span style="display:flex;"><span>Step 1/2 : FROM tomcat
</span></span><span style="display:flex;"><span> ---&gt; 3639174793ba
</span></span><span style="display:flex;"><span>Step 2/2 : RUN echo “hello docker” &gt; /usr/local/tomcat/webapps/ROOT/index.html
</span></span><span style="display:flex;"><span> ---&gt; Running in c96cba308c1f
</span></span><span style="display:flex;"><span>Removing intermediate container c96cba308c1f
</span></span><span style="display:flex;"><span> ---&gt; caafbd6ff4d7
</span></span><span style="display:flex;"><span>Successfully built caafbd6ff4d7
</span></span><span style="display:flex;"><span>Successfully tagged test:latest
</span></span></code></pre></div><h3 id="copy指令">COPY指令</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>COPY xxx.zip /usr/local/tomcat/webapps/ROOT
</span></span><span style="display:flex;"><span>RUN unzip xxx.zip
</span></span></code></pre></div><h3 id="workdir指令">WORKDIR指令</h3>
<p>指定一个工作目录</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>WORKDIR /usr/local/tomcat/webapps/ROOT
</span></span></code></pre></div><h4 id="构建一个tomcat项目镜像">构建一个tomcat项目镜像</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>FROM tomcat
</span></span><span style="display:flex;"><span>WORKDIR /usr/local/tomcat/webapps/ROOT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>RUN rm -rf *
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>COPY xxx.zop .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>RUN unzip xxx.zip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>RUN rm -rf xxx.zip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>WORKDIR /usr/local/tomcat
</span></span></code></pre></div><p>构建</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>l1nker4@zero:/usr/local/docker/tomcat$ docker build -t xxx .
</span></span><span style="display:flex;"><span>Sending build context to Docker daemon   38.4kB
</span></span><span style="display:flex;"><span>Step 1/7 : FROM tomcat
</span></span><span style="display:flex;"><span> ---&gt; 3639174793ba
</span></span><span style="display:flex;"><span>Step 2/7 : WORKDIR /usr/local/tomcat/webapps/ROOT
</span></span><span style="display:flex;"><span> ---&gt; Running in ee67259a7a84
</span></span><span style="display:flex;"><span>Removing intermediate container ee67259a7a84
</span></span><span style="display:flex;"><span> ---&gt; 32c64a82f43b
</span></span><span style="display:flex;"><span>Step 3/7 : RUN rm -rf *
</span></span><span style="display:flex;"><span> ---&gt; Running in 9c44abff5efd
</span></span><span style="display:flex;"><span>Removing intermediate container 9c44abff5efd
</span></span><span style="display:flex;"><span> ---&gt; 20a5867132f8
</span></span><span style="display:flex;"><span>Step 4/7 : COPY xxx.zip .
</span></span><span style="display:flex;"><span> ---&gt; c182ed4b79c8
</span></span><span style="display:flex;"><span>Step 5/7 : RUN unzip xxx.zip
</span></span><span style="display:flex;"><span> ---&gt; Running in 445e7367894f
</span></span><span style="display:flex;"><span>Archive:  xxx.zip
</span></span><span style="display:flex;"><span>  inflating: rbac.jpg.jpeg           
</span></span><span style="display:flex;"><span>Removing intermediate container 445e7367894f
</span></span><span style="display:flex;"><span> ---&gt; d567880bc000
</span></span><span style="display:flex;"><span>Step 6/7 : RUN rm -rf xxx.zip
</span></span><span style="display:flex;"><span> ---&gt; Running in 2875fbb6a7f8
</span></span><span style="display:flex;"><span>Removing intermediate container 2875fbb6a7f8
</span></span><span style="display:flex;"><span> ---&gt; 08ee1b530f77
</span></span><span style="display:flex;"><span>Step 7/7 : WORKDIR /usr/local/tomcat
</span></span><span style="display:flex;"><span> ---&gt; Running in 96a93d9b9091
</span></span><span style="display:flex;"><span>Removing intermediate container 96a93d9b9091
</span></span><span style="display:flex;"><span> ---&gt; a15ba09df769
</span></span><span style="display:flex;"><span>Successfully built a15ba09df769
</span></span><span style="display:flex;"><span>Successfully tagged xxx:latest
</span></span></code></pre></div><h3 id="add指令">ADD指令</h3>
<p>和COPY的格式和性质类似，但是有新增的功能。源路径可以是一个<code>URL</code>，下载后文件权限设置为<code>600</code>（当前用户可读可写，小组无权限，其他组无权限）</p>
<p>如果源路径是一个<code>tar</code>压缩文件，可以自动解压。</p>
<h2 id="4docker守护态运行">4.Docker守护态运行</h2>
<p>同时启动两个tomcat</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run -p 8080:8080 --name tomcat -d tomcat
</span></span><span style="display:flex;"><span>docker run -p 8081:8080 --name tomcat1 -d tomcat
</span></span></code></pre></div><h2 id="5数据卷">5.数据卷</h2>
<ul>
<li>数据卷是一个或多个容器使用的特殊目录</li>
<li>数据卷可以在容器之间共享和重用</li>
<li>对数据卷的修改会立刻更新</li>
<li>对数据卷的更新，不会影响镜像</li>
<li>数据卷默认会一直存在，即使容器删除</li>
</ul>
<p>问题：容器被销毁，容器中的数据将一并被销毁，容器中的数据不是持久化存在的。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run -p 8080:8080 --name tomcat -d -v /usr/local/docker/tomcat/ROOT:/usr/local/tomcat/webapps/ROOT
</span></span></code></pre></div><p>相当于将宿主机的目录映射到docker容器中目录。</p>
<h4 id="安装mysql">安装MySQL</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run -p 3306:3306 --name mysql <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-v /usr/local/docker/conf:/etc/mysql <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-v /usr/local/docker/logs:/var/log/mysql <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-v /usr/local/docker/data:/var/lib/mysql <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span><span style="color:#ae81ff">123456</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-d mysql:5.7.22
</span></span></code></pre></div><h2 id="6docker-compose">6.Docker Compose</h2>
<p>Docker官方开源项目，Compose定位是定义和运行多个Docker容器的应用。</p>
<p>两个概念</p>
<ul>
<li>服务：一个应用的容器，可以运行多个相同镜像的容器实例。</li>
<li>项目：由一组关联的应用容器组成一个完整的业务单元，在<code>docker-compose.yml</code>中定义。</li>
</ul>
<h3 id="1安装docker-compose">1.安装Docker-compose</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -L https://github.com/docker/compose/releases/download/1.25.0-rc1/docker-compose-<span style="color:#e6db74">`</span>uname -s<span style="color:#e6db74">`</span>-<span style="color:#e6db74">`</span>uname -m<span style="color:#e6db74">`</span> -o /usr/local/bin/docker-compose
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chmod +x /usr/local/bin/docker-compose
</span></span></code></pre></div><h4 id="docker-compose部署tomcat">Docker Compose部署Tomcat</h4>
<p><code>docker-compose.yml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">tomcat</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">tomcat</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">tomcat</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">8080</span>:<span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/usr/local/docker/tomcat/webapps/test:/usr/local/tomcat/webapps/test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">TZ</span>: <span style="color:#ae81ff">Asia/Shanghai</span>
</span></span></code></pre></div><h2 id="reference">Reference</h2>
<p><a href="http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">Docker入门教程</a></p>
<p><a href="http://jm.taobao.org/2016/05/12/introduction-to-docker">Docker 容器概念</a></p>

        </div>

        <div class="row middle-xs">
          <div class="col-xs-12">
            
            <div class="post-tags">
              <a href="/tags/docker/">
                Docker
              </a>
            </div>
            
          </div>
        </div>
        
          <div class="row">
            <div class="col-xs-12">
              
            </div>
          </div>

          



          
          
          <div style="height: 50px;"></div>
          
          <div class="post-comments">
            <div id="disqus_thread"></div>
<script>
  window.addEventListener("load", () => {
    (function() {
      
      var d = document,
        s = d.createElement("script");
      s.src = "https://evl1nker4.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  });
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>

          </div>
          
        

        <div class="site-footer">
  
  
</div>

      </div>
    </div>
  </article>

  

<script>
  
  
    
    
  
</script>

  

</body>

</html>